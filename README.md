# Lesion_Detection_and_Segmentation_of_Diabetic_Retinopathy
This project focuses on lesion segmentation for diabetic retinopathy detection using retinal images. It includes the identification of hemorrhages, micro-aneurysms, and exudates (hard and soft), aiding in early diagnosis. Blood vessel and optic disc segmentation are not included.

# Lesion Segmentation in Diabetic Retinopathy

This repository contains deep learning-based methods for detecting and segmenting retinal lesions associated with **Diabetic Retinopathy (DR)**. The goal is to automate lesion identification from retinal fundus images using two different approaches:

-  Patch-Based Binary Classification  
-  Pixel-Level Multi-Class Segmentation (UNet3+)

---

## Experiment 1: Patch-Based Lesion Classification

This method involves classifying image patches as containing lesions or not. It’s useful when detailed pixel-level labels are unavailable or computational resources are limited.

###  Methodology

1. **Data Preprocessing**
   - Retinal images and lesion masks are loaded from the dataset.
   - Binary masks are generated by combining multiple lesion types (e.g., hemorrhages, exudates).
   - Patches are extracted from the images and corresponding masks.

2. **Patch Classification**
   - A CNN is trained to classify each patch as "lesion" or "non-lesion".
   - Balanced datasets are created using positive and negative patches.
   - Predictions are aggregated to reconstruct full-image segmentation maps.

3. **Model Evaluation**
   - Accuracy, precision, and Jaccard Index (IoU) are used to evaluate patch classification performance.
   - Final lesion masks are visualized for qualitative analysis.

###  Pros
- Simpler training setup.
- Works well with imbalanced datasets using patch sampling.
- Can be trained with limited data.

---

## Experiment 2: Multi-Class Lesion Segmentation with UNet3+

This approach performs **semantic segmentation** to identify and distinguish between different lesion types directly at the pixel level.

### Methodology

1. **Data Preparation**
   - Input images are resized to 256×256.
   - Lesion-specific masks (CWS, Hemorrhages, Hard Exudates, Micro-aneurysms) are combined into a 5-channel target mask (4 lesions + background).
   - Masks are one-hot encoded to support multi-class segmentation.

2. **Model Architecture**
   - Based on the **UNet 3+** architecture.
   - Features:
     - Deep skip connections
     - Batch normalization
     - Dropout for regularization
     - Multi-channel output for class-wise predictions

3. **Training**
   - Loss functions: Categorical Crossentropy, optionally combined with Dice Loss.
   - Evaluation metric: **Mean IoU** across all classes.
   - EarlyStopping and ModelCheckpoint callbacks are used to prevent overfitting.

4. **Visualization**
   - Predicted masks are compared with ground truth.
   - Pixel-wise classification allows clear boundary detection and lesion classification.

### Pros
- Handles multiple lesion types in a single model.
- Higher spatial precision due to pixel-level prediction.
- More suitable for medical-grade segmentation applications.

---

## Dataset

The project uses a dataset structured as follows:

- `DB0`: Training set with:
  - Fundus images
  - Ground truth masks (CWS, H, HE, MA)
- `DB1`: Testing set with the same structure

 Subfolders used for lesion masks: `CWS`, `H`, `HE`, `MA`

---

## Tools & Libraries

- **Python 3**
- **TensorFlow / Keras**
- OpenCV
- scikit-learn
- NumPy, Matplotlib
- Jupyter Notebook (for experimentation)

---

## Summary of Methods

| Method                     | Lesion Types       | Output Type         | Approach           | Model            |
|---------------------------|--------------------|---------------------|--------------------|------------------|
| Patch-Based Classification| Combined Binary    | Patch-wise Labels   | Classification     | Simple CNN       |
| UNet3+ Multi-Class        | CWS, H, HE, MA     | Pixel-wise Segments | Semantic Segmentation | UNet3+ (Custom)  |

---

## Results

Each method was evaluated on the test set:

- **Patch Classification**: Reported patch-level accuracy and IoU
- **UNet3+ Segmentation**: Reported Mean IoU for multi-class predictions
